theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette2)+
#theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1
p1a=plot_bar(ps2_cnat, fill="Order")+
facet_grid(.~timepoint,scales="free",space="free")+
geom_bar(aes(fill=Order), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12,angle=90,vjust=0.5))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette2)+
#theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1a
p1a=plot_bar(ps2_cnat, fill="Family")+
facet_grid(.~timepoint,scales="free",space="free")+
geom_bar(aes(fill=Family), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12,angle=90,vjust=0.5))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette2)+
#theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1a
p2=plot_bar(ps2_dlab, "colony", fill="Family")+
facet_grid(.~timepoint,scales="free",space="free")+
geom_bar(aes(fill=Family), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette2)+
#theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p2
p2a=plot_bar(ps2_dlab, fill="Family")+
facet_grid(.~timepoint,scales="free",space="free")+
geom_bar(aes(fill=Family), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12,angle=90,vjust=0.5))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette2)+
#theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p2a
p3<-plot_grid(p1a+theme(legend.position="none"),p2a,align = 'vh',nrow=2)
p3
p3<-plot_grid(p1a,p2a,align = 'vh',nrow=2)
p3
pdf("barchart_Family_CNAT.pdf",width=11)
p1a=plot_bar(ps2_cnat, fill="Family")+
facet_grid(.~timepoint,scales="free",space="free")+
geom_bar(aes(fill=Family), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12,angle=90,vjust=0.5))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette2)+
#theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1a
dev.off()
pdf("barchart_Family_DLAB.pdf",width=11)
p2a=plot_bar(ps2_dlab, fill="Family")+
facet_grid(.~timepoint,scales="free",space="free")+
geom_bar(aes(fill=Family), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12,angle=90,vjust=0.5))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette2)+
#theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p2a
dev.off()
pdf("barchart_Family_CNAT.pdf",width=11)
p1a=plot_bar(ps2_cnat, fill="Family")+
facet_grid(.~timepoint,scales="free",space="free")+
geom_bar(aes(fill=Family), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=10,angle=90,vjust=0.5))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette2)+
#theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1a
dev.off()
pdf("barchart_Family_DLAB.pdf",width=11)
p2a=plot_bar(ps2_dlab, fill="Family")+
facet_grid(.~timepoint,scales="free",space="free")+
geom_bar(aes(fill=Family), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=10,angle=90,vjust=0.5))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette2)+
#theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p2a
dev.off()
pdf("barchart_Family_CNAT.pdf",width=11)
p1a=plot_bar(ps2_cnat, fill="Family")+
facet_grid(.~timepoint,scales="free",space="free")+
geom_bar(aes(fill=Family), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=10,angle=90,vjust=0.5))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette2)+
theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1a
dev.off()
pdf("barchart_Family_DLAB.pdf",width=11)
p2a=plot_bar(ps2_dlab, fill="Family")+
facet_grid(.~timepoint,scales="free",space="free")+
geom_bar(aes(fill=Family), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=10,angle=90,vjust=0.5))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette2)+
theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p2a
dev.off()
otu <- read.table("silva_nochloronomito_otu_table_ps2_RA.txt",sep="\t",header=TRUE, row.names=1)
taxon <- read.table("silva_nochloronomito_taxa_table_ps2.txt",sep="\t",header=TRUE,row.names=1)
samples<-read.table("metadata_ps2.txt",sep="\t",header=T,row.names=1)
OTU = otu_table(otu, taxa_are_rows=FALSE)
taxon<-as.matrix(taxon)
TAX = tax_table(taxon)
sampledata = sample_data(samples)
ps2_ra <- phyloseq(otu_table(otu, taxa_are_rows=FALSE),
sample_data(samples),
tax_table(taxon))
ps2_ra
ps2_cnat = subset_samples(ps2_ra, coral.species == "Colpophyllia natans")
ps2_cnat  # 89 taxa and 82 samples
sample_data(ps2_cnat)$timepoint<-factor(sample_data(ps2_cnat)$timepoint,levels=c("Initial","2-month"))
ps2_dlab = subset_samples(ps2_ra, coral.species == "Diploria labyrinthiformis")
ps2_dlab  # 89 taxa and 80 samples
sample_data(ps2_dlab)$timepoint<-factor(sample_data(ps2_dlab)$timepoint,levels=c("Initial","2-month"))
ps2_ra_f = tax_glom(ps2_ra, "Family")
otu <- read.table("silva_nochloronomito_otu_table_ps2_RA.txt",sep="\t",header=TRUE, row.names=1)
taxon <- read.table("silva_nochloronomito_taxa_table_ps2.txt",sep="\t",header=TRUE,row.names=1)
samples<-read.table("metadata_ps2.txt",sep="\t",header=T,row.names=1)
OTU = otu_table(otu, taxa_are_rows=FALSE)
taxon<-as.matrix(taxon)
TAX = tax_table(taxon)
sampledata = sample_data(samples)
ps2_ra <- phyloseq(otu_table(otu, taxa_are_rows=FALSE),
sample_data(samples),
tax_table(taxon))
ps2_ra
get_taxa_unique(ps2_ra, "Family")
# Plotting most abundant families - first collapse ASVs into families then reshape data for plotting
ps2_ra_f = tax_glom(ps2_ra, "Family")
View(otu)
View(ps2_ra)
View(taxon)
library(dada2)
library(phyloseq)
library(CoDaSeq)
library(vegan)
library(pairwiseAdonis)
library(corncob)
library(ggplot2)
library(randomcoloR)
library(cowplot)
library(knitr)
library(dplyr)
library(reshape2)
library(tibble)
writeLines(capture.output(sessionInfo()), "sessionInfo.txt")
otu <- read.table("silva_nochloronomito_otu_table_ps2_RA.txt",sep="\t",header=TRUE, row.names=1)
taxon <- read.table("silva_nochloronomito_taxa_table_ps2.txt",sep="\t",header=TRUE,row.names=1)
samples<-read.table("metadata_ps2.txt",sep="\t",header=T,row.names=1)
OTU = otu_table(otu, taxa_are_rows=FALSE)
taxon<-as.matrix(taxon)
TAX = tax_table(taxon)
sampledata = sample_data(samples)
ps2_ra <- phyloseq(otu_table(otu, taxa_are_rows=FALSE),
sample_data(samples),
tax_table(taxon))
ps2_ra
get_taxa_unique(ps2_ra, "Family") #46
# Plotting most abundant families - first collapse ASVs into families then reshape data for plotting
ps2_ra_f = tax_glom(ps2_ra, "Family")
otu <- read.table("silva_nochloronomito_otu_table_ps2_RA.txt",sep="\t",header=TRUE, row.names=1)
taxon <- read.table("silva_nochloronomito_taxa_table_ps2.txt",sep="\t",header=TRUE,row.names=1)
samples<-read.table("metadata_ps2.txt",sep="\t",header=T,row.names=1)
OTU = otu_table(otu, taxa_are_rows=FALSE)
taxon<-as.matrix(taxon)
TAX = tax_table(taxon)
sampledata = sample_data(samples)
ps2_ra <- phyloseq(otu_table(otu, taxa_are_rows=FALSE),
sample_data(samples),
tax_table(taxon))
ps2_ra
get_taxa_unique(ps2_ra, "Class")
n <- 33
# after plotting, you can re-run the next line to create a different selection of colors
palette <- distinctColorPalette(n)
ps2_cnat = subset_samples(ps2_ra, coral.species == "Colpophyllia natans")
ps2_cnat
sample_data(ps2_cnat)$timepoint<-factor(sample_data(ps2_cnat)$timepoint,levels=c("Initial","2-month"))
ps2_dlab = subset_samples(ps2_ra, coral.species == "Diploria labyrinthiformis")
ps2_dlab
sample_data(ps2_dlab)$timepoint<-factor(sample_data(ps2_dlab)$timepoint,levels=c("Initial","2-month"))
p1a=plot_bar(ps2_cnat, fill="Order")+
facet_grid(.~timepoint,scales="free",space="free")+
geom_bar(aes(fill=Order), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12,angle=90,vjust=0.5))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette)+
#theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1a
p2a=plot_bar(ps2_dlab, fill="Order")+
facet_grid(.~timepoint,scales="free",space="free")+
geom_bar(aes(fill=Order), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12,angle=90,vjust=0.5))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette)+
#theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p2a
# Plot families
get_taxa_unique(ps2_ra, "Family") # 46 families
n <- 46
# after plotting, you can re-run the next line to create a different selection of colors
palette2 <- distinctColorPalette(n)
p1a=plot_bar(ps2_cnat, fill="Family")+
facet_grid(.~timepoint,scales="free",space="free")+
geom_bar(aes(fill=Family), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=10,angle=90,vjust=0.5))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette2)+
theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1a
# after plotting, you can re-run the next line to create a different selection of colors
palette2 <- distinctColorPalette(n)
p1a=plot_bar(ps2_cnat, fill="Family")+
facet_grid(.~timepoint,scales="free",space="free")+
geom_bar(aes(fill=Family), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=10,angle=90,vjust=0.5))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette2)+
theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1a
pdf("barchart_Family_CNAT.pdf",width=11)
p1a=plot_bar(ps2_cnat, fill="Family")+
facet_grid(.~timepoint,scales="free",space="free")+
geom_bar(aes(fill=Family), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=10,angle=90,vjust=0.5))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette2)+
theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1a
dev.off()
pdf("barchart_Family_DLAB.pdf",width=11)
p2a=plot_bar(ps2_dlab, fill="Family")+
facet_grid(.~timepoint,scales="free",space="free")+
geom_bar(aes(fill=Family), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=10,angle=90,vjust=0.5))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette2)+
theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p2a
dev.off()
otu <- read.table("silva_nochloronomito_otu_table_ps2_RA.txt",sep="\t",header=TRUE, row.names=1)
taxon <- read.table("silva_nochloronomito_taxa_table_ps2.txt",sep="\t",header=TRUE,row.names=1)
samples<-read.table("metadata_ps2.txt",sep="\t",header=T,row.names=1)
OTU = otu_table(otu, taxa_are_rows=FALSE)
taxon<-as.matrix(taxon)
TAX = tax_table(taxon)
sampledata = sample_data(samples)
ps2_ra <- phyloseq(otu_table(otu, taxa_are_rows=FALSE),
sample_data(samples),
tax_table(taxon))
ps2_ra
ps2_ra_f = tax_glom(ps2_ra, "Family")
ps2_ra_f
otu_f = as(otu_table(ps2_ra_f), "matrix")
taxon_f = as(tax_table(ps2_ra_f), "matrix")
fam<-t(otu_f)
fam <- as.data.frame(fam)
fam <- tibble::rownames_to_column(fam, "ASV")
taxon_f <- as.data.frame(taxon_f)
taxon_f <- tibble::rownames_to_column(taxon_f, "ASV")
fam_tax <- merge(fam, taxon_f, by="ASV", all=FALSE)
fam_tax$Genus<-NULL
fam_tax$ASV<-NULL
# Order by total relative abundance and choose top 25 families
fam_tax <- fam_tax %>% mutate("total" = rowSums((fam_tax[,1:96]), na.rm = TRUE))
fam_tax <- fam_tax[order(fam_tax$total, decreasing = TRUE),]
fam25 <- fam_tax[1:25,]
fam25$total<-NULL
fam_long<-melt(fam25,value.name="proportion",variable.name="sample",id.vars=c("Kingdom","Phylum","Class","Order","Family"))
# Merge with metadata for plotting aesthetics
samples <- as.data.frame(samples)
samples <- tibble::rownames_to_column(samples, "sample")
famplot <- merge(fam_long,samples,by="sample", all=TRUE)
View(famplot)
View(samples)
sample_data(famplot)$timepoint<-factor(sample_data(famplot)$timepoint,levels=c("Initial","2-month"))
View(famplot)
famplot$timepoint<-factor(famplot$timepoint,levels=c("Initial","2-month"))
p <- ggplot(famplot, aes(sample, Family, fill= proportion)) + geom_tile()+
facet_grid(.~Timepoint,scales="free",space="free")+
theme(axis.text.x=element_text(angle=90))+
#theme(axis.text.y=element_text(face="italic"))+
theme(axis.title.x=element_blank())+
theme(axis.title.y=element_blank())+
scale_fill_gradient(low="white", high="#004488")
p
p <- ggplot(famplot, aes(sample, Family, fill= proportion)) + geom_tile()+
facet_grid(.~timepoint,scales="free",space="free")+
theme(axis.text.x=element_text(angle=90))+
#theme(axis.text.y=element_text(face="italic"))+
theme(axis.title.x=element_blank())+
theme(axis.title.y=element_blank())+
scale_fill_gradient(low="white", high="#004488")
p
View(famplot)
View(famplot)
View(fam25)
View(fam_tax)
View(fam_tax)
otu <- read.table("silva_nochloronomito_otu_table_ps2_RA.txt",sep="\t",header=TRUE, row.names=1)
taxon <- read.table("silva_nochloronomito_taxa_table_ps2.txt",sep="\t",header=TRUE,row.names=1)
samples<-read.table("metadata_ps2.txt",sep="\t",header=T,row.names=1)
OTU = otu_table(otu, taxa_are_rows=FALSE)
taxon<-as.matrix(taxon)
TAX = tax_table(taxon)
sampledata = sample_data(samples)
ps2_ra <- phyloseq(otu_table(otu, taxa_are_rows=FALSE),
sample_data(samples),
tax_table(taxon))
ps2_ra
ps2_ra_f = tax_glom(ps2_ra, "Family")
ps2_ra_f
otu_f = as(otu_table(ps2_ra_f), "matrix")
taxon_f = as(tax_table(ps2_ra_f), "matrix")
fam<-t(otu_f)
View(fam)
View(taxon_f)
fam <- as.data.frame(fam)
fam <- tibble::rownames_to_column(fam, "ASV")
taxon_f <- as.data.frame(taxon_f)
taxon_f <- tibble::rownames_to_column(taxon_f, "ASV")
fam_tax <- merge(fam, taxon_f, by="ASV", all=FALSE)
View(fam_tax)
otu <- read.table("silva_nochloronomito_otu_table_ps2_RA.txt",sep="\t",header=TRUE, row.names=1)
taxon <- read.table("silva_nochloronomito_taxa_table_ps2.txt",sep="\t",header=TRUE,row.names=1)
samples<-read.table("metadata_ps2.txt",sep="\t",header=T,row.names=1)
OTU = otu_table(otu, taxa_are_rows=FALSE)
taxon<-as.matrix(taxon)
TAX = tax_table(taxon)
sampledata = sample_data(samples)
ps2_ra <- phyloseq(otu_table(otu, taxa_are_rows=FALSE),
sample_data(samples),
tax_table(taxon))
ps2_ra
ps2_ra_f = tax_glom(ps2_ra, "Family")
ps2_ra_f
otu_f = as(otu_table(ps2_ra_f), "matrix")
View(otu_f)
taxon_f = as(tax_table(ps2_ra_f), "matrix")
View(taxon_f)
fam<-t(otu_f)
View(fam)
View(otu_f)
View(fam)
View(taxon_f)
fam <- tibble::rownames_to_column(fam, "ASV")
fam <- as.data.frame(fam)
fam <- tibble::rownames_to_column(fam, "ASV")
View(fam)
taxon_f <- as.data.frame(taxon_f)
taxon_f <- tibble::rownames_to_column(taxon_f, "ASV")
View(taxon_f)
fam_tax <- merge(fam, taxon_f, by="ASV", all=FALSE)
View(fam_tax)
fam_tax <- merge(fam, taxon_f, by="ASV", all=TRUE)
View(fam_tax)
otu <- read.table("silva_nochloronomito_otu_table_ps2_RA.txt",sep="\t",header=TRUE, row.names=1)
taxon <- read.table("silva_nochloronomito_taxa_table_ps2.txt",sep="\t",header=TRUE,row.names=1)
samples<-read.table("metadata_ps2.txt",sep="\t",header=T,row.names=1)
OTU = otu_table(otu, taxa_are_rows=FALSE)
taxon<-as.matrix(taxon)
TAX = tax_table(taxon)
sampledata = sample_data(samples)
ps2_ra <- phyloseq(otu_table(otu, taxa_are_rows=FALSE),
sample_data(samples),
tax_table(taxon))
ps2_ra
ps2_ra_f = tax_glom(ps2_ra, "Family")
ps2_ra_f
otu_f = as(otu_table(ps2_ra_f), "matrix")
taxon_f = as(tax_table(ps2_ra_f), "matrix")
fam<-t(otu_f)
fam <- as.data.frame(fam)
fam <- tibble::rownames_to_column(fam, "ASV")
taxon_f <- as.data.frame(taxon_f)
taxon_f <- tibble::rownames_to_column(taxon_f, "ASV")
View(taxon_f)
View(fam)
fam_tax <- merge(fam, taxon_f, by="ASV", all=TRUE)
View(fam_tax)
fam_tax$Genus<-NULL
fam_tax$ASV<-NULL
View(fam_tax)
# Order by total relative abundance and choose top 25 families
fam_tax <- fam_tax %>% mutate("total" = rowSums((fam_tax[,1:152]), na.rm = TRUE))
fam_tax <- fam_tax[order(fam_tax$total, decreasing = TRUE),]
View(fam_tax)
fam25 <- fam_tax[1:25,]
fam25$total<-NULL
fam_long<-melt(fam25,value.name="proportion",variable.name="sample",id.vars=c("Kingdom","Phylum","Class","Order","Family"))
View(fam_long)
samples <- as.data.frame(samples)
samples <- tibble::rownames_to_column(samples, "sample")
famplot <- merge(fam_long,samples,by="sample", all=TRUE)
View(famplot)
View(ps2_ra)
famplot$timepoint<-factor(famplot$timepoint,levels=c("Initial","2-month"))
# manually sort families by relative abundance, list order: first in list = bottom of y-axis
famplot$Family<-factor(famplot$Family,levels=c("Bacteroidia","Burkholderiaceae","Rhodospirillaceae","Paraspirulinaceae","AB1","Alphaproteobacteria","Kiloniellaceae","Bacteria","Fusibacteraceae","Woeseiaceae","Endozoicomonadaceae","Desulfocapsaceae","Desulfovibrionaceae","Nitrosopumilaceae","Cyanobacteriaceae","Phormidiaceae","Campylobacterales","Hyphomonadaceae","Flavobacteriaceae","Blastocatellaceae","Paracoccaceae","Terasakiellaceae","Vibrionaceae","Amoebophilaceae","Ga0077536"))
p <- ggplot(famplot, aes(sample, Family, fill= proportion)) + geom_tile()+
facet_grid(.~timepoint,scales="free",space="free")+
theme(axis.text.x=element_text(angle=90))+
#theme(axis.text.y=element_text(face="italic"))+
theme(axis.title.x=element_blank())+
theme(axis.title.y=element_blank())+
scale_fill_gradient(low="white", high="#004488")
p
View(sampledata)
p <- ggplot(famplot, aes(sample, Family, fill= proportion)) + geom_tile()+
facet_grid(coral.species~timepoint,scales="free",space="free")+
theme(axis.text.x=element_text(angle=90))+
#theme(axis.text.y=element_text(face="italic"))+
theme(axis.title.x=element_blank())+
theme(axis.title.y=element_blank())+
scale_fill_gradient(low="white", high="#004488")
p
famplotC$timepoint<-factor(famplotC$timepoint,levels=c("Initial","2-month"))
famplotC <- famplot %>% filter(Species =='Colpophyllia natans')
famplotC <- famplot %>% filter(coral.species =='Colpophyllia natans')
famplotD <- famplot %>% filter(coral.species =='Diploria labyrinthiformis')
famplotC$timepoint<-factor(famplotC$timepoint,levels=c("Initial","2-month"))
famplotC$Family<-factor(famplotC$Family,levels=c("Bacteroidia","Burkholderiaceae","Rhodospirillaceae","Paraspirulinaceae","AB1","Alphaproteobacteria","Kiloniellaceae","Bacteria","Fusibacteraceae","Woeseiaceae","Endozoicomonadaceae","Desulfocapsaceae","Desulfovibrionaceae","Nitrosopumilaceae","Cyanobacteriaceae","Phormidiaceae","Campylobacterales","Hyphomonadaceae","Flavobacteriaceae","Blastocatellaceae","Paracoccaceae","Terasakiellaceae","Vibrionaceae","Amoebophilaceae","Ga0077536"))
famplotD$timepoint<-factor(famplotD$timepoint,levels=c("Initial","2-month"))
famplotD$Family<-factor(famplotD$Family,levels=c("Bacteroidia","Burkholderiaceae","Rhodospirillaceae","Paraspirulinaceae","AB1","Alphaproteobacteria","Kiloniellaceae","Bacteria","Fusibacteraceae","Woeseiaceae","Endozoicomonadaceae","Desulfocapsaceae","Desulfovibrionaceae","Nitrosopumilaceae","Cyanobacteriaceae","Phormidiaceae","Campylobacterales","Hyphomonadaceae","Flavobacteriaceae","Blastocatellaceae","Paracoccaceae","Terasakiellaceae","Vibrionaceae","Amoebophilaceae","Ga0077536"))
pc <- ggplot(famplotC, aes(sample, Family, fill= proportion)) + geom_tile()+
facet_grid(.~timepoint,scales="free",space="free")+
theme(axis.text.x=element_text(angle=90))+
#theme(axis.text.y=element_text(face="italic"))+
theme(axis.title.x=element_blank())+
theme(axis.title.y=element_blank())+
scale_fill_gradient(low="white", high="#004488")
pc
pd <- ggplot(famplotD, aes(sample, Family, fill= proportion)) + geom_tile()+
facet_grid(.~timepoint,scales="free",space="free")+
theme(axis.text.x=element_text(angle=90))+
#theme(axis.text.y=element_text(face="italic"))+
theme(axis.title.x=element_blank())+
theme(axis.title.y=element_blank())+
scale_fill_gradient(low="white", high="#004488")
pd
pdf("Top25families_CNAT.pdf", bg ="white", width=8.5)
pc <- ggplot(famplotC, aes(sample, Family, fill= proportion)) + geom_tile()+
facet_grid(.~timepoint,scales="free",space="free")+
theme(axis.text.x=element_text(angle=90))+
#theme(axis.text.y=element_text(face="italic"))+
theme(axis.title.x=element_blank())+
theme(axis.title.y=element_blank())+
scale_fill_gradient(low="white", high="#004488")
pc
dev.off()
pdf("Top25families_DLAB.pdf", bg ="white", width=8.5)
pd <- ggplot(famplotD, aes(sample, Family, fill= proportion)) + geom_tile()+
facet_grid(.~timepoint,scales="free",space="free")+
theme(axis.text.x=element_text(angle=90))+
#theme(axis.text.y=element_text(face="italic"))+
theme(axis.title.x=element_blank())+
theme(axis.title.y=element_blank())+
scale_fill_gradient(low="white", high="#004488")
pd
dev.off()
